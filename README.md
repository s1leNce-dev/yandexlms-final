# üì° –ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä —Ä–∞—Å–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω—ã—Ö –≤—ã—á–∏—Å–ª–µ–Ω–∏–π

–†–∞—Å–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω—ã–π –≤—ã—á–∏—Å–ª–∏—Ç–µ–ª—å –∞—Ä–∏—Ñ–º–µ—Ç–∏—á–µ—Å–∫–∏—Ö –≤—ã—Ä–∞–∂–µ–Ω–∏–π. –§–∏–Ω–∞–ª

---

## üöÄ –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å

- –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –∏ –≤—Ö–æ–¥ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- –ó–∞—â–∏—â—ë–Ω–Ω—ã–π –¥–æ—Å—Ç—É–ø –∫ API —á–µ—Ä–µ–∑ JWT (–≤ cookie)
- –û—Ç–ø—Ä–∞–≤–∫–∞ –≤—ã—Ä–∞–∂–µ–Ω–∏–π –¥–ª—è –≤—ã—á–∏—Å–ª–µ–Ω–∏–π (–ø–æ–¥–¥–µ—Ä–∂–∫–∞ `+ - * /`)
- –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –≤—ã—Ä–∞–∂–µ–Ω–∏–π –Ω–∞ –ø–æ–¥–∑–∞–¥–∞—á–∏
- –†–∞—Å–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ —á–µ—Ä–µ–∑ gRPC-–∞–≥–µ–Ω—Ç–æ–≤
- –•—Ä–∞–Ω–µ–Ω–∏–µ –∏ –ø—Ä–æ—Å–º–æ—Ç—Ä –∏—Å—Ç–æ—Ä–∏–∏ –≤—ã—á–∏—Å–ª–µ–Ω–∏–π
- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ –∏ –º–æ–¥—É–ª—å–Ω—ã–µ —Ç–µ—Å—Ç—ã

---

## üì¶ –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏

- –Ø–∑—ã–∫: Go
- –í–µ–±-—Ñ—Ä–µ–π–º–≤–æ—Ä–∫: Gin
- –ë–î: SQLite + GORM
- –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è: JWT + Cookie
- gRPC: –¥–ª—è –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è —Å –∞–≥–µ–Ω—Ç–∞–º–∏
- Docker: –¥–ª—è –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü–∏–∏
- –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ: `go test`

---

## üîß –ó–∞–ø—É—Å–∫ –ø—Ä–æ–µ–∫—Ç–∞

### ‚úÖ –í–∞—Ä–∏–∞–Ω—Ç 1: Docker Compose

```bash
docker-compose up --build
````

* API –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–µ–Ω –ø–æ –∞–¥—Ä–µ—Å—É: `http://localhost:8000/api/v1`
* gRPC —Å–µ—Ä–≤–∏—Å –±—É–¥–µ—Ç –∑–∞–ø—É—â–µ–Ω –Ω–∞ –ø–æ—Ä—Ç—É: `:50051`

---

### üß™ –í–∞—Ä–∏–∞–Ω—Ç 2: –†—É—á–Ω–æ–π –∑–∞–ø—É—Å–∫

#### 1. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω Go 1.20+

#### 2. –ó–∞–ø—É—Å–∫ —Å–µ—Ä–≤–∏—Å–∞

```bash
go run ./cmd/calc_service/...
```

#### 3. –ó–∞–ø—É—Å–∫ gRPC –∞–≥–µ–Ω—Ç–∞ (–≤ –æ—Ç–¥–µ–ª—å–Ω–æ–π –≤–∫–ª–∞–¥–∫–µ —Ç–µ—Ä–º–∏–Ω–∞–ª–∞):

```bash
go run ./cmd/agent/...
```

---

## üîê –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è

### –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è

```bash
curl --location 'http://localhost:8000/api/v1/regin' \
--header 'Content-Type: application/json' \
--data '{
  "login": "user1",
  "password": "pass123"
}'
```

‚úÖ –£—Å–ø–µ—à–Ω—ã–π –æ—Ç–≤–µ—Ç:

```json
{ "message": "success" }
```

---

### –í—Ö–æ–¥

```bash
curl --location 'http://localhost:8000/api/v1/login' \
--header 'Content-Type: application/json' \
--data '{
  "login": "user1",
  "password": "pass123"
}'
```

‚úÖ –£—Å–ø–µ—à–Ω—ã–π –æ—Ç–≤–µ—Ç:

```json
{ "message": "success" }
```

*–ü–æ—Å–ª–µ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –≤ cookie —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—é—Ç—Å—è JWT-—Ç–æ–∫–µ–Ω—ã.*

---

## üì° –ü—Ä–∏–º–µ—Ä—ã API-–∑–∞–ø—Ä–æ—Å–æ–≤

### üì• –û—Ç–ø—Ä–∞–≤–∫–∞ –≤—ã—Ä–∞–∂–µ–Ω–∏—è

```bash
curl --location 'http://localhost:8000/api/v1/user/calculate' \
--header 'Content-Type: application/json' \
--header 'Cookie: jwt_access=<–≤–∞—à_—Ç–æ–∫–µ–Ω>' \
--data '{
  "expression": "2 + 2 * 2"
}'
```

‚úÖ –£—Å–ø–µ—à–Ω—ã–π –æ—Ç–≤–µ—Ç:

```json
{ "id": 1 }
```

‚ùå –û—à–∏–±–∫–∞:

```json
{ "error": "Invalid expression format" }
```

---

### üìÑ –ü–æ–ª—É—á–µ–Ω–∏–µ –≤—Å–µ—Ö –≤—ã—Ä–∞–∂–µ–Ω–∏–π

```bash
curl --location 'http://localhost:8000/api/v1/user/expressions' \
--header 'Cookie: jwt_access=<–≤–∞—à_—Ç–æ–∫–µ–Ω>'
```

‚úÖ –ü—Ä–∏–º–µ—Ä –æ—Ç–≤–µ—Ç–∞:

```json
{
  "expressions": [
    { "ID": 1, "Status": "done", "Result": "6" },
    { "ID": 2, "Status": "pending", "Result": null }
  ]
}
```

---

### üîç –ü–æ–ª—É—á–µ–Ω–∏–µ –≤—ã—Ä–∞–∂–µ–Ω–∏—è –ø–æ ID

```bash
curl --location 'http://localhost:8000/api/v1/user/expressions/1' \
--header 'Cookie: jwt_access=<–≤–∞—à_—Ç–æ–∫–µ–Ω>'
```

‚úÖ –û—Ç–≤–µ—Ç:

```json
{
  "expression": {
    "ID": 1,
    "Status": "done",
    "Result": "6",
    "Tasks": [...]
  }
}
```

‚ùå –û—à–∏–±–∫–∞:

```json
{ "error": "Expression not found" }
```

---

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

–ú–æ–¥—É–ª—å–Ω—ã–µ –∏ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã:

```bash
go test ./...
```

---

## ‚öô –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

```env
# Server
SERVER_HOST="0.0.0.0"
SERVER_PORT="8000"

# JWT_SECRETS
JWT_ACCESS_TOKEN="jwt_access228"
JWT_REFRESH_TOKEN="jwt_refresh1337"
```

---

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞

```text
cmd/
  ‚îú‚îÄ calc_service/     # –ó–∞–ø—É—Å–∫ REST API + gRPC-—Å–µ—Ä–≤–µ—Ä–∞
  ‚îî‚îÄ agent/            # gRPC –∞–≥–µ–Ω—Ç

internal/
  ‚îú‚îÄ handlers/
  ‚îú‚îÄ middlewares/
  ‚îú‚îÄ models/
  ‚îú‚îÄ proto/
  ‚îî‚îÄ utils/

docker-compose.yml
```

